<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

 <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" />
 <script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
 <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.js"></script>
 <script src="js/leaflet.groupedlayercontrol.js" type="text/javascript"></script>
 

<style>
#map1 { height: 600px; width: 600px; margin-right: 5px; }
#map2 { height: 650px; width: 260px; margin-right: 5px;}
#map3 { height: 650px; width: 260px;}
#attribution {
  font: 12px/1.5 Lato, "Helvetica Neue", Helvetica, Arial, sans-serif;
  color: #555;}

td {
     text-align: center;
     font-weight: bold;
}



</style>

<title>CA Beach Vegetation Literature Map</title>

</head>

<body>
<div class="wrapper">

<header>
    <img src="images/Logo_Squares_500x488px.png" alt="Tobias Research Logo" style="float:left; padding: 10px; width:100px;height:100px">
    <h1>California Beach Plant</h1> 
    <h1>Literature Map</h1>
    <p>Michele M. Tobias, PhD</p>
    <p>University of California, Davis</p>
    <p>mmtobias[at]ucdavis.edu</p>
    
    <p class="view"><a href="https://github.com/MicheleTobias/maps">View the Project on GitHub <small>MicheleTobias/maps</small></a></p>
        <ul>
          <li><a href="https://github.com/MicheleTobias/maps">Project On <strong>GitHub</strong></a></li>
          <li><a href="https://sites.google.com/site/mtobiasresearch/">Research <strong>Website</strong></a></li>
        </ul>
        
</header>
<section>
<h3>Introduction</h3>
<p> <strong>Coming soon!</strong>  A description of what this map shows <strong>PLUS!</strong> how you can use it, contribute, and donate! </p>
<p> What you currently see on this page is a proof-of-concept.  The locations are made up and assigned at random to the citations.  A real map is coming real soon.  Pinky swear.

<p>Contributors: Alex Mandel</p>
</section>

<section>
<p class = "view">
<div id="map1"></div>
<script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
<script src="js/leaflet.groupedlayercontrol.js"></script>
<script type="text/javascript">

var map1 = L.map('map1').setView([37, -119.5], 6);

var osm = L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png').addTo(map1);
//var watercolor = L.tileLayer('http://b.tile.stamen.com/watercolor/{z}/{x}/{y}.png').addTo(map1);

var myLayer = L.geoJson().addTo(map1);
var xmlhttp = new XMLHttpRequest();
var url = 'https://api.zotero.org/users/2338633/collections/NR8XU5N6/items?v=3';

xmlhttp.onreadystatechange = function() {
    if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
        var myArr = JSON.parse(xmlhttp.responseText);
        myFunction(myArr);
    }
}
xmlhttp.open("GET", url, true);
xmlhttp.send();


function myFunction(arr) {
    var parsetext;
    var i;
    for(i = 0; i < arr.length; i++) { 
        var pophttp = new XMLHttpRequest();
        var popurl = 'https://api.zotero.org/users/2338633/items/'+ arr[i].data.key +'?format=bib&v=3';
                
        parsetext = '[{"type": "Feature", "properties":{"key": "' + arr[i].data.key + '", "popupContent": "<iframe src= '+ popurl + '></> + "}, "geometry":' + arr[i].data.extra + '}]';
        var geojsonFeature = JSON.parse(parsetext);
        
        L.geoJson(geojsonFeature, {
            pointToLayer: function (feature, latlng) {
            return L.circleMarker(latlng, {
            radius: 4,
            fillOpacity: 1
            }).bindPopup(feature.properties.popupContent);
                }
            }).addTo(myLayer);
        }};

</script>
</div>
</p>
</section>





</body>